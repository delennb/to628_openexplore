---
title: "hw2_dataloadandclean"
author: "Delenn Bauer"
date: "2024-04-16"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## HW Data Load and Clean

### Load Libraries and Data

```{r}
library(caret)
library(neuralnet)
library(C50)
library(foreach)
library(doParallel)
library(class)
```

### Data Load

```{r}
#Downloading and Prepping the Data
banana <- read.csv("banana_quality.csv", stringsAsFactors = TRUE)
str(banana)
```

### Transform and Split Data

```{r, cache=TRUE}
banana$y <- ifelse(banana$Quality == "Good", 1, 0)
str(banana)
banana$Quality <- NULL
str(banana)
summary(banana)

# Using model.matrix to convert all the factors to dummy variables
# We are converting all of the factors into dummy variables as the input into knn has to be numeric

bananaa <- as.data.frame(model.matrix(~.-1,banana))
str(bananaa)

# Randomize the rows in the data (shuffling the rows)
set.seed(12345)
banana_random <- bananaa[sample(nrow(bananaa)),]
str(banana_random)
```

```{r, cache=TRUE}
#Normalize the data

# ALREADY NORMALIZED


# normalize <- function(x) {
#   return ((x - min(x)) / (max(x) - min(x)))
# }
# 
# # we are going to normalize everything 
# tele_norm <- as.data.frame(lapply(tele_random, normalize))
banana_norm <- banana_random
# str(tele_norm)
```

```{r, cache=TRUE}
set.seed(12345)
train_ratio = 0.5

train_rows <- sample(1:nrow(banana_random), train_ratio*nrow(banana_random))
```

```{r, cache=TRUE}
# LR & DT
banana_train <- banana_random[train_rows,]
banana_test <- banana_random[-train_rows,]

write.csv(banana_train, "banana_train.csv", row.names = FALSE)
write.csv(banana_test, "banana_test.csv", row.names = FALSE)
```

```{r, cache=TRUE}
# ANN
banana_train_ann <- banana_norm[train_rows,]
banana_test_ann <- banana_norm[-train_rows,]

write.csv(banana_train_ann, "banana_train_ann.csv", row.names = FALSE)
write.csv(banana_test_ann, "banana_test_ann.csv", row.names = FALSE)
```

```{r, cache=TRUE}
# KNN
banana_train_knn <- banana_train_ann
banana_train_knn_label <- banana_train$y
banana_train_knn$y <- NULL

banana_test_knn <- banana_test_ann
banana_test_knn_label <- banana_test$y
banana_test_knn$y <- NULL

write.csv(banana_train_knn, "banana_train_knn.csv", row.names = FALSE)
write.csv(banana_test_knn, "banana_test_knn.csv", row.names = FALSE)
write.csv(banana_train_knn_label, "banana_train_knn_label.csv", row.names = FALSE)
write.csv(banana_test_knn_label, "banana_test_knn_label.csv", row.names = FALSE)
```
