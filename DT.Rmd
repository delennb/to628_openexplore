---
title: "DT"
author: "Delenn Bauer"
date: "2024-04-10"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## DT

### Load Libraries and Data

```{r}
library(caret)
library(C50) # for decision tree

carinsurance_train_dt <- read.csv("carinsurance_train.csv")
carinsurance_test_dt <- read.csv("carinsurance_test.csv")

```

### Build Model

```{r, cache=TRUE}
dtmodel <- C5.0(as.factor(OUTCOME1) ~ ., data = carinsurance_train_dt)
```

```{r, cache=TRUE}
dt_pred <- predict(dtmodel, carinsurance_test_dt)
```

```{r, cache=TRUE}
dt_cm <- confusionMatrix(as.factor(dt_pred), as.factor(carinsurance_test_dt$OUTCOME1), positive = "1")
dt_cm

write.csv(dt_pred, "dt_pred.csv", row.names = FALSE)
```


```{r, cache=TRUE}
TN <- dt_cm$table[1,1]
FN <- dt_cm$table[1,2]
FP <- dt_cm$table[2,1]
TP <- dt_cm$table[2,2]

# Profit
dt_profit <- 5000*TP - 500*FP
dt_kappa <- dt_cm$overall["Kappa"]

dt_profit
dt_kappa
```
